<%  # should pass local variable of "plans" and "namespace" and "show_institution"
    # plans is the collection of plans to show
    # namespace is a string to add to the front of parameters to keep them separate
    # show_institution is a boolean that indicates whether the institution column should be shown
%>




<table class="table table-striped">
  <thead>

    <tr>
      <%# sortable_group namespace: namespace do %>
        <th class="span5"><%= sortable :name, namespace: namespace %></th>
        <th class="span5"><%= sortable :requirements_template_id, t('.funder_template_link'), namespace: namespace %></th>

        <% if show_institution %>
          <th class="span5"><%= sortable :institution_id, namespace: namespace %></th>
        <% end %>

        <th class="span5"><%= sortable :owner, namespace: namespace %></th>
        <th><%= t('.download') %></th>

        <% if namespace == :institutional %>
         <th><%= sortable :visibility, namespace: namespace %></th>
        <% end %>
      <%# end %>
    </tr>

</thead>
<tbody>


  <% plans.each do |plan| %>
    <tr>
      <td class="plan_name">
        <div class="toggle-links">
          <strong><%= plan.name %></strong>
        </div>
      </td>
      <td>
        <%= (plan.requirements_template && plan.requirements_template.name) || '' %>
      </td>
      <% if show_institution %>
        <td>
          <%= plan.owner.institution.name %>
        </td>
      <% end %>
      <td>
        <%= plan.owner.full_name %>
      </td>
      <td class="span1">
        <%= link_to('', plan_path(plan, format: "pdf"), :class => 'icon pdf', :target => '_blank') %>
      </td>
      <%unless plan.visibility == :public %>
        <td>
          <%= t_enum(plan, :visibility) %>
        </td>
      <%end%>
    </tr>
  <% end %>
  </tbody>
  </table>

  <% if params["#{namespace}:all_scope"] == "all" %>
    <div class="buttons pagination">
      <%= render_button_link t: '.view_less',
                             href: filter_params.merge("#{namespace}:all_scope" => 'less') %>
      <%= paginate plans, :param_name => "#{namespace}:page" %>
    </div>
  <% else %>
    <div class="buttons pagination">
      <%= render_button_link t: '.view_all',
                             href: filter_params.merge("#{namespace}:all_scope" => 'all') %>
      <%= paginate plans, :param_name => "#{namespace}:page" %>
    </div>
  <%end%>




